# Найденные баги в API

## Критические баги

### BUG-001: XSS уязвимость в поле name
Приоритет: Критический
**Тест:** `test_negative.py::TestNegative::test_tc039_xss_in_name`

**Описание:**  
API не экранирует HTML/JavaScript код в поле `name` объявления. Это позволяет внедрить вредоносный скрипт, который будет выполнен в браузере пользователя.

**Шаги воспроизведения:**
1. Создать объявление с `name: "<script>alert('XSS')</script>"`
2. Получить объявление через GET `/api/1/item/{id}`
3. Проверить поле `name` в ответе

**Ожидаемое поведение:**  
Скрипт должен быть экранирован: `&lt;script&gt;alert('XSS')&lt;/script&gt;`

**Фактическое поведение:**  
Скрипт возвращается без изменений: `<script>alert('XSS')</script>`

**Риски:**
- XSS атаки
- Кража сессий пользователей
- Фишинг
- Изменение содержимого страницы

---

## Высокий приоритет

### BUG-002: API принимает отрицательные цены
**Серьезность:** Высокий
**Тест:** `test_create_item.py::TestCreateItem::test_tc003_negative_price`

**Описание:**  
API позволяет создавать объявления с отрицательной ценой, что не имеет смысла в бизнес-логике.

**Шаги воспроизведения:**
1. Отправить POST `/api/1/item` с `price: -1000`
2. API возвращает 200 и создает объявление

**Ожидаемое поведение:**  
API должен вернуть 400 Bad Request с сообщением об ошибке валидации

**Фактическое поведение:**  
API возвращает 200 и успешно создает объявление с отрицательной ценой

**Пример запроса:**
```json
{
  "sellerID": 555123,
  "name": "Тестовый товар",
  "price": -1000,
  "statistics": {
    "likes": 1,
    "viewCount": 1,
    "contacts": 1
  }
}
```

---

### BUG-003: API принимает отрицательные значения статистики
Приоритет: Высокий
**Тест:** `test_create_item.py::TestCreateItem::test_tc009_negative_statistics`

**Описание:**  
API позволяет создавать объявления с отрицательными значениями в полях `likes`, `viewCount`, `contacts`, что противоречит логике счетчиков.

**Шаги воспроизведения:**
1. Отправить POST `/api/1/item` с отрицательными значениями статистики
2. API возвращает 200 и создает объявление

**Ожидаемое поведение:**  
API должен вернуть 400 Bad Request, так как счетчики не могут быть отрицательными

**Фактическое поведение:**  
API возвращает 200 и успешно создает объявление

**Пример запроса:**
```json
{
  "sellerID": 555123,
  "name": "Тестовый товар",
  "price": 5000,
  "statistics": {
    "likes": -5,
    "viewCount": -10,
    "contacts": -3
  }
}
```

---

## Средний приоритет

### BUG-004: API не принимает нулевые значения статистики
**Приоритет:** Средний
**Тест:** `test_negative.py::TestBoundaryValues::test_tc045_zero_statistics`

**Описание:**  
API отклоняет создание объявлений с нулевыми значениями в полях статистики (`likes: 0`, `viewCount: 0`, `contacts: 0`), хотя это валидные начальные значения для новых объявлений.

**Шаги воспроизведения:**
1. Отправить POST `/api/1/item` с нулевыми значениями статистики
2. API возвращает 400 с сообщением "поле likes обязательно"

**Ожидаемое поведение:**  
API должен принимать нулевые значения как валидные начальные значения счетчиков

**Фактическое поведение:**  
API возвращает 400 Bad Request

**Ответ API:**
```json
{
  "result": {
    "message": "поле likes обязательно",
    "messages": {}
  },
  "status": "400"
}
```

---

### BUG-005: API принимает отрицательный sellerID
**Приоритет**: Средний
**Статус:** Открыт  
**Тест:** `test_seller_items.py::TestSellerItems::test_tc017_negative_seller_id`

**Описание:**  
API позволяет получать объявления для отрицательного `sellerID`, что может быть нежелательным поведением.

**Шаги воспроизведения:**
1. Отправить GET `/api/1/-123/item`
2. API возвращает 200 с объявлениями

**Ожидаемое поведение:**  
API должен вернуть 400 или 404, так как ID продавца не может быть отрицательным

**Фактическое поведение:**  
API возвращает 200 и список объявлений с `sellerId: -123`

---
